{
    "scopeName": "source.flowlang",
    "fileTypes": [
        "flow"
    ],
    "patterns": [
        {"include": "#comment"},
        {"include": "#directive"},
        {"include": "#flag"},
        {"include": "#group-block"},
        {"include": "#rule-components"}
    ],
    "repository": {
        "comment": {
            "patterns": [
                {
                    "name": "comment.line.double-slash.flowlang",
                    "match": "//.*"
                }
            ]
        },
        "directive": {
            "patterns": [
                {
                    "name": "keyword.control.directive.flowlang",
                    "match": "@(Universe|Model|Steps|DefaultLLM|net|ncd|ncr|async|Test)"
                },
                {
                    "name": "punctuation.separator.directive.flowlang",
                    "match": ":"
                }
            ]
        },
        "flag": {
            "patterns": [
                {
                    "name": "storage.modifier.flag.flowlang",
                    "match": "(-[a-zA-Z][a-zA-Z0-9_]*)\\[?[^\\[\\]]*\\]?"
                }
            ]
        },
        "group-block": {
            "patterns": [
                {
                    "name": "punctuation.section.grouping.flowlang",
                    "match": "[\\{\\}\\(\\)]"
                }
            ]
        },
        "rule-components": {
            "patterns": [
                {
                    "name": "keyword.operator.flow-operation.flowlang",
                    "match": "(-->)|(>-<)|(>>)<<|(>>)|(<<)|(->)|(>)|(><)"
                },
                {
                    "name": "entity.name.tag.rule-symbol.flowlang",
                    "match": "\\b[a-zA-Z0-9_]+\\b"
                },
                {
                    "name": "string.regexp.flowlang",
                    "begin": "/",
                    "end": "/",
                    "patterns": [
                        {"include": "source.regexp"}
                    ]
                },
                {
                    "name": "string.quoted.double.llm-prompt.flowlang",
                    "begin": "\"",
                    "end": "\"",
                    "patterns": [
                        {"include": "constant.character.escape"}
                    ]
                },
                {
                    "name": "constant.numeric.range-index.flowlang",
                    "match": "\\[\\s*-?\\d*\\s*(,\\s*-?\\d*\\s*)?\\]"
                },
                {
                    "name": "punctuation.terminator.statement.flowlang",
                    "match": ";"
                }
            ]
        }
    }
}
